<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"  xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>丁小样同学</title>
    <description></description>
    <link>http://blog.dinghz.com</link>
    <language>zh-CN</language>
    <copyright>Copyright 2015, blog.dinghz.com</copyright>
    <docs>http://blogs.law.harvard.edu/tech/rss</docs>
    <generator>丁小样同学</generator>
    <atom:link href="http://blog.dinghz.com/rss.xml" rel="self" type="application/rss+xml" />

    
    <item>
      <title>5年前自己写的一个小框架</title>
      <description>
        <![CDATA[
        <h3>工程项目</h3>

<ol>
<li><p>框架命名： <code>easybean</code></p></li>
<li><p><code>github</code>地址： <a href="https://github.com/craneding/craneding/tree/master/easybean">https://github.com/craneding/craneding/tree/master/easybean</a></p></li>
<li><p>功能简介:</p>

<p>简化数据库操作，框架使用jdbc进行封装；采用了原始SQL语句操作作为请求，结果可轻松转换成Java Bean实体对象或Map；自动匹配实体对象的字段名与SQL的字段名字，如果名字不一致，可通过注解的方式在实体对象的字段属性中配置。</p></li>
<li><p>点赞</p>

<p>框架虽然不咋地，现在一看也有不少缺陷，对于5年前的自己能有这样的想法和写出来，真的得给自己一个赞。</p></li>
</ol>

<h3>实验代码</h3>

<h4>实体对象</h4>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**</span>
<span class="cm"> * </span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">easybean</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.easybean.annotation.Column</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.easybean.annotation.Table</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author crane.ding</span>
<span class="cm"> * </span>
<span class="cm"> */</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;User&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;username&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUsername</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;id=&quot;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&quot; username=&quot;</span> <span class="o">+</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<h4>测试代码</h4>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**</span>
<span class="cm"> * </span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">easybean</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.easybean.EasyBean</span><span class="o">;</span>


<span class="cm">/**</span>
<span class="cm"> * @author crane.ding</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestEasyBean</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="n">TestDataSource</span> <span class="n">dataSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TestDataSource</span><span class="o">();</span>

    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setUrl</span><span class="o">(</span><span class="s">&quot;jdbc:h2:database/h2demo&quot;</span><span class="o">);</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&quot;craneding&quot;</span><span class="o">);</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">&quot;123456&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="n">EasyBean</span> <span class="n">easyBean</span> <span class="o">=</span> <span class="n">EasyBean</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">org</span><span class="o">.</span><span class="na">h2</span><span class="o">.</span><span class="na">Driver</span><span class="o">.</span><span class="na">load</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">new</span> <span class="nf">Thread</span><span class="o">(){</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="n">test3</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">test3</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test3</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">easyBean</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span>

            <span class="kt">int</span> <span class="n">maxCount</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>

            <span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="o">(</span><span class="n">Long</span><span class="o">)</span><span class="n">easyBean</span>
                <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;select count(*) as C from user&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">findUniqueMap</span><span class="o">()</span>
                <span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;C&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">count</span><span class="o">);</span>

            <span class="kt">long</span> <span class="n">page</span> <span class="o">=</span> <span class="o">(</span><span class="n">count</span> <span class="o">%</span> <span class="n">maxCount</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">?</span> <span class="o">(</span><span class="n">count</span> <span class="o">/</span> <span class="n">maxCount</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">count</span> <span class="o">/</span> <span class="n">maxCount</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>

            <span class="kt">int</span> <span class="n">startIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">page</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">findList</span> <span class="o">=</span> <span class="n">easyBean</span>
                    <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;select * from user u order by u.id&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">findList</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">startIndex</span><span class="o">,</span> <span class="n">maxCount</span><span class="o">);</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">findList</span><span class="o">);</span>

                <span class="n">startIndex</span> <span class="o">+=</span> <span class="n">maxCount</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="n">easyBean</span><span class="o">.</span><span class="na">commitTransaction</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">easyBean</span><span class="o">.</span><span class="na">endTransaction</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">(</span><span class="n">TestDataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">EasyBean</span> <span class="n">easyBean</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">EasyBean</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>

        <span class="n">easyBean</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Object</span> <span class="n">key</span> <span class="o">=</span> <span class="n">easyBean</span>
                    <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;select max(u.id) + 1 as key from user u&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">findUniqueMap</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;KEY&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

            <span class="n">easyBean</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;insert into user (id, username) values(?, ?)&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">addParameters</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="s">&quot;crane.ding@163.com&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">save</span><span class="o">();</span>

            <span class="n">easyBean</span><span class="o">.</span><span class="na">commitTransaction</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">easyBean</span><span class="o">.</span><span class="na">endTransaction</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">(</span><span class="n">TestDataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">EasyBean</span> <span class="n">easyBean</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">EasyBean</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">easyBean</span>
            <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;select max(u.id) + 1 as key from user u&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findListMap</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

        <span class="n">easyBean</span>
            <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;insert into user (id, username) values(?, ?)&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addParameters</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;KEY&quot;</span><span class="o">)</span> <span class="o">,</span><span class="s">&quot;crane.ding@hotye.com&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">save</span><span class="o">();</span>

        <span class="n">easyBean</span>
            <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;update user u set u.username = ? where u.id = ?&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addParameters</span><span class="o">(</span><span class="s">&quot;crane.ding@gmail.com&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
            <span class="o">.</span><span class="na">update</span><span class="o">();</span>

        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">easyBean</span>
            <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;select id, username from user u where u.id = ?&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addParameters</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findUnique</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span> <span class="o">=</span> <span class="n">easyBean</span>
            <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;select id, username from user u&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findList</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">users</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
        ]]>
      </description>
      <pubDate>2015-08-30T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2015/08/30/easybean.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2015/08/30/easybean</guid>
    </item>
    
    <item>
      <title>JQueryMobile页面跳转与数据传递</title>
      <description>
        <![CDATA[
        <h3>页面跳转</h3>

<ol>
<li><p><code>&lt;a&gt;</code> 标签:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;a/b.html&quot;</span> <span class="na">data-transition=</span><span class="s">&quot;slide&quot;</span><span class="nt">&gt;</span>丁小样同学博客<span class="nt">&lt;/a&gt;</span>
</code></pre></div></li>
<li><p><code>&lt;form&gt;</code> 标签:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">&quot;get&quot;</span> <span class="na">action=</span><span class="s">&quot;a/b.html&quot;</span> <span class="na">id=</span><span class="s">&quot;form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>名称:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui-input-text ui-body-inherit ui-corner-all ui-shadow-inset&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;remark&quot;</span><span class="nt">&gt;</span>备注:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui-input-text ui-body-inherit ui-corner-all ui-shadow-inset&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">name=</span><span class="s">&quot;remark&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;ui-btn&quot;</span><span class="nt">&gt;</span>页面切换<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>    
</code></pre></div></li>
<li><p><code>js</code> 代码:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&quot;form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>名称:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui-input-text ui-body-inherit ui-corner-all ui-shadow-inset&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">id=</span><span class="s">&quot;name&quot;</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;remark&quot;</span><span class="nt">&gt;</span>备注:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui-input-text ui-body-inherit ui-corner-all ui-shadow-inset&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">id=</span><span class="s">&quot;remark&quot;</span> <span class="na">name=</span><span class="s">&quot;remark&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;javascript:ajaxPost();&quot;</span> <span class="na">class=</span><span class="s">&quot;ui-btn&quot;</span><span class="nt">&gt;</span>页面切换<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">ajaxPost</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">mobile</span><span class="p">.</span><span class="nx">changePage</span><span class="p">(</span><span class="s2">&quot;a/b.html&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;post&quot;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">name</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#form&quot;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#name&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
                <span class="nx">remark</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#form&quot;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#remark&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">});</span>
 <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></li>
</ol>

<h3>获取页面数据</h3>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script&gt;</span>

<span class="kd">function</span> <span class="nx">getUrlParam</span><span class="p">(</span><span class="nx">string</span><span class="o">:</span><span class="nx">string</span><span class="p">)</span><span class="o">:</span><span class="nx">any</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">();</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">string</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">urlToJson</span><span class="p">(</span><span class="nx">string</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">string</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">urlToJson</span><span class="p">(</span><span class="nx">url</span><span class="o">:</span><span class="nx">string</span><span class="p">)</span><span class="o">:</span><span class="nx">any</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">();</span>

     <span class="kd">var</span> <span class="nx">strs</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">);</span>
     <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">strs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">tempArr</span> <span class="o">=</span> <span class="nx">strs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">);</span>
         <span class="nx">obj</span><span class="p">[</span><span class="nx">tempArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">tempArr</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\+/g</span><span class="p">,</span> <span class="s2">&quot;%20&quot;</span><span class="p">));</span>
     <span class="p">}</span>

     <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;pagebeforechange&quot;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;pagebeforechange&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toPage</span> <span class="o">!=</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">mobile</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">parseUrl</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">baseURI</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">pageUrl</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">direction</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">direction</span> <span class="o">==</span> <span class="s2">&quot;back&quot;</span><span class="p">)</span> <span class="p">{</span><span class="c1">// 返回</span>
            <span class="c1">//TODO</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="c1">// 进入</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;get&quot;</span><span class="p">)</span> <span class="p">{</span><span class="c1">// get</span>
                <span class="c1">// 获取数据 getUrlParam(url.href)           </span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="c1">// post</span>
                <span class="c1">// 获取数据 data.options.data</span>
            <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<blockquote>
<p>注：上面代码通过[$(e.target).find(&quot;#子页面page ID&quot;);]</p>
</blockquote>

<h3>预加载页面</h3>

<ol>
<li><p>在开发移动应用时，对需要链接的页面进行预加载是十分有必要的。因为当一个链接页面设置成为预加载方式时，在当前页面加载完成之后，目标页面也被自动加载到当前文档中，用户单击就可以马上打开，大大加快了页面访问的速度。</p></li>
<li><p>设置链接页面预加载，在<code>&lt;a&gt;</code>标签中添加<code>data-prefetch</code>属性，并将属性值设为true。在JQuery Mobile中要实现页面的预加载，另外一种方法是调用JavaScript代码中的全局性方法<code>$.mobile.loadPage()</code>，其效果跟<code>data-prefetch</code>一样。</p></li>
</ol>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;about.html&quot;</span><span class="na">rel=</span><span class="s">&quot;external&quot;</span> <span class="na">data-prefetch=</span><span class="s">&quot;ture&quot;</span><span class="nt">&gt;</span>点击进入<span class="nt">&lt;/a&gt;</span>
</code></pre></div>
<h3>缓存页面</h3>

<ol>
<li><p>在JQuery Mobile中，可以通过页面缓存的方式将访问过的历史内容写入页面文档的缓存中，当用户重新访问时，不需要重新加载，只要从缓存中读取就可以。</p></li>
<li><p>保留所有访问过的页面</p></li>
</ol>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script&gt;</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">mobile</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">domCache</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<ol>
<li>缓存特定的页面</li>
</ol>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">data-role=</span><span class="s">&quot;page&quot;</span> <span class="na">id=</span><span class="s">&quot;cacheMe&quot;</span> <span class="na">data-dom-cache=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
        ]]>
      </description>
      <pubDate>2015-08-29T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2015/08/29/jquerymobile.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2015/08/29/jquerymobile</guid>
    </item>
    
    <item>
      <title>不翻墙也能更新和管理Android SDK</title>
      <description>
        <![CDATA[
        <h3>Android SDK在线更新镜像服务器</h3>

<ol>
<li><p>中国科学院开源协会镜像站地址:</p>

<p>IPV4/IPV6: <a href="http://mirrors.opencas.cn">http://mirrors.opencas.cn</a> 端口：80</p>

<p>IPV4/IPV6: <a href="http://mirrors.opencas.org">http://mirrors.opencas.org</a> 端口：80</p>

<p>IPV4/IPV6: <a href="http://mirrors.opencas.ac.cn">http://mirrors.opencas.ac.cn</a> 端口：80</p></li>
<li><p>上海GDG镜像服务器地址:</p>

<p><a href="http://sdk.gdgshanghai.com">http://sdk.gdgshanghai.com</a> 端口：8000</p></li>
<li><p>北京化工大学镜像服务器地址:</p>

<p>IPv4: <a href="http://ubuntu.buct.edu.cn/">http://ubuntu.buct.edu.cn/</a> 端口：80</p>

<p>IPv4: <a href="http://ubuntu.buct.cn/">http://ubuntu.buct.cn/</a> 端口：80</p>

<p>IPv6: <a href="http://ubuntu.buct6.edu.cn/">http://ubuntu.buct6.edu.cn/</a> 端口：80</p></li>
<li><p>大连东软信息学院镜像服务器地址:</p>

<p><a href="http://mirrors.neusoft.edu.cn">http://mirrors.neusoft.edu.cn</a> 端口：80</p></li>
</ol>

<p>使用方法：</p>

<ol>
<li><p>启动Android SDK Manager（相关命令：anrorid sdk），打开主界面，依次选择【Tools】、【Options】，弹出【Android SDK Manager - Settings】窗口</p></li>
<li><p>在【Android SDK Manager - Settings】窗口中，在【HTTP Proxy Server】和【HTTP Proxy Port】输入框内填入上面镜像服务器地址（不包含http:// ，如下图）和端口，并且选中【Force https://... source to be fetched using http://...】复选框。</p></li>
<li><p>依次选择【Packages】、【Reload】。</p></li>
</ol>

<p><img width="40%" height="20%" alt="SDK Manager Proxy Settings" src="http://www.androiddevtools.cn/static/image/sdk-manager-proxy-settings.png"></p>

<blockquote>
<p>本文参考：<a href="http://www.androiddevtools.cn/">Android Dev Tools官网</a></p>
</blockquote>

        ]]>
      </description>
      <pubDate>2015-08-29T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2015/08/29/androiddevtools.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2015/08/29/androiddevtools</guid>
    </item>
    
    <item>
      <title>手机app快速开发的经验</title>
      <description>
        <![CDATA[
        <h3>app开发模式</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目前app平台有Android和IOS两大平台，对于一般的手机应用来说我们只需开发这两个平台的app（对于类似新浪微博、微信、QQ这样的高群体用户来说，那就必须支持所有的平台，包括：IOS，Android，Palm，Symbian，WP7，WP8，Bada和Blackberry）。目前手机app的开发模式有两大模式，分别为原生开发和混搭Web开发。对于中小团队来说我建议使用混搭Web开发的模式，因为使用原生开发需要对每个平台分不同的团队来进行开发，这样团队人员和开发进度将会是一个瓶颈。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;混搭Web开发，首选是使用PhongGap、HTML5、CSS3、JavaScript。<a href="http://phonegap.com/">Phonegap</a>是一个用基于HTML，CSS和JavaScript的，创建移动跨平台移动应用程序的快速开发平台。它使开发者能够利用iPhone，Android，Palm，Symbian，WP7，WP8，Bada和Blackberry智能手机的核心功能。目前几乎所有的Android和IOS系统的手机都支持HTML5和CSS3（唯一的差别就是个别比较旧的浏览器对某些特性不支持或支持的不完美）。</p>

<h3>信息推送信息</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自己开发信息推送？不建议，除非你的团队足够大或者有比较特殊的保密信息才建议自己开发。信息推送我们先说主流的手机平台（Android和IOS），Android和IOS的推送机制完成不一样，Android是手机应用于应用后台服务之间的通讯；IOS是基于苹果公司提供的消息推送服务(APNS)，其原理就是，第三方应用将要推送给用户的信息推送到苹果服务器，苹果服务器再通过统一的系统接口将这些信息推送到用户的手机上。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用比较成熟的信息推送框架，会给我们的手机app开发带来不少的便利。这里推荐<a href="https://www.jpush.cn/common/products">极光推送</a>，极光推送也是比较成熟的
信息推送系统，其平台整合了Android推送、iOS推送的统一推送服务。一般企业用户使用其免费版本也就足够了，想要了解免费版和收费版的区别<a href="https://www.jpush.cn/common/price">请看这里</a>，其它不多说，搞的好像给它做广告是的。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;极光推送平台当然不是唯一的选择，还有<a href="http://push.baidu.com/">百度的云推送</a>，推送（Push）是百度开放云向开发者提供的消息推送服务；通过利用云端与客户端之间建立稳定、可靠的长连接来为开发者提供向客户端应用推送实时消息的一种开发者服务。目前百度&quot;云推送&quot;服务是完全免费的，只支持 Android及iOS两个平台。也是这两年才推出的服务，相对来说是一个比较新的平台。本人还没怎么去研究其跟极光推送平台的差异和对比其优劣。不过我个人比较喜欢百度的开发服务平台，基本都是免费而且很全，如果是我选择的话，我会选择百度云推送。</p>

<h3>社会化分享</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;社会化分享已经成为一个app必不可少的一个模块。新浪微博，腾讯微博，QQ空间，人人网，开心网，微信，QQ好友等平台的分享，难道我们都需要对每个平台进行对接吗，那我们的工作量和维护量得多大啊？刚刚才说百度的开发服务平台很全，现在就给你推荐它的另一个服务<a href="http://developer.baidu.com/soc/share">百度社会化分享组件</a>，该组件有IOS、Android和Webapp三种模式。目前支持新浪微博、腾讯微博、QQ空间、开心网、微信好友、微信朋友圈进行分享，同时支持Android系统的邮件、短信同步分享。</p>

<h3>统计分析和监控</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;统计分析这对app来说也是相当重要的一部分，它可以帮你更好的了解你的app的健康情况和用户分析等。这一方面百度的开发服务平台也提供了非常全面的服务，<a href="http://tongji.baidu.com/web/welcome/login">百度统计-网站统计</a>、<a href="http://mtj.baidu.com/web/welcome/login">百度统计-移动统计</a>等等。百度统计-网站统计<a href="http://tongji.baidu.com/web/5473605/overview/multi?siteId=1942168">演示地址</a>，百度统计-移动统计<a href="http://mtj.baidu.com/web/overview?appId=19">演示地址</a>。</p>

<h3>应用测试与发布</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这么多手机型号，难道每一种手机型号都要买来测试吗？不用，咱们还是可以使用<a href="http://mtc.baidu.com/mtc/">百度移动云测试</a>。对于一个app在内测阶段的app，怎么管理你的版本和快速测试呢，这<a href="http://www.pgyer.com/">蒲公英 - 免费的应用托管平台|App应用众测分发</a>可以帮到你。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发布到应用市场，对于IOS来说就相对简单，因为都是必须在早苹果的App Store进行发布。而Android就不一样，每个厂商都搞自己应用市场，五花八门，一个个发布那是相当的麻烦，你也可以使用<a href="https://www.zhuamob.com/">抓猫</a>，来进行统一发布。</p>

        ]]>
      </description>
      <pubDate>2015-07-09T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2015/07/09/appdevelper.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2015/07/09/appdevelper</guid>
    </item>
    
    <item>
      <title>Linux wget命令整站下载做网站镜像</title>
      <description>
        <![CDATA[
        <h3>普通下载</h3>

<p>简单的下载文件，类似浏览器的文件下载功能。</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>wget http://www.xxx.com/abc/file.zip
</code></pre></div>
<h3>断点续传</h3>

<p>文件大或网络慢不稳定的时候，文件还没下载完成，连接就断开又得重新下载。这个时候可以使用wget的断点续传，只需要在使用的时候加-c参数。</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>wget -c http://www.xxx.com/abc/file.zip
</code></pre></div>
<h3>批量下载</h3>

<p>有多个文件需要下载，那么你只要给wget一个下载清单即可批量下载。编写一个文件，文件的每一行都是需要下载的url地址，然后使用-i参数。</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"># download.txt
http://www.xxx.com/abc/file1.zip
http://www.xxx.com/abc/file2.zip
http://www.xxx.com/abc/file3.zip
</code></pre></div><div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>wget -i download.txt
</code></pre></div>
<h3>选择性下载</h3>

<p>可以指定下载某种类型文件，或者不下载某种文件。</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>wget -m -reiect<span class="o">=</span>gif http://www.xxx.com/abc/

<span class="c"># -reject=gif 表示忽略gif文件</span>
<span class="c"># -accept=gif 表示下载gif文件</span>
</code></pre></div>
<h3>整站下载</h3>

<p>可以以递归的方式下载整站，并将下载的页面的链接转换为本地链接，同时可以忽略robots.txt协议和模拟User-Agent。</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>wget -r -p -np -k -e <span class="nv">robots</span><span class="o">=</span>off -U <span class="s2">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0&quot;</span> http://www.xxx.com/abc/

<span class="c"># -r,  --recursive（递归)</span>
<span class="c"># -k,  --convert-links（转换链接）</span>
<span class="c"># -p,  --page-requisites（页面必需元素）</span>
<span class="c"># -np, --no-parent（不追溯至父级）</span>
<span class="c"># -e robots=off, --忽略robots.txt协议</span>
<span class="c"># -U, 模拟User-Agent</span>
</code></pre></div>
        ]]>
      </description>
      <pubDate>2015-07-05T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2015/07/05/linuxwget.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2015/07/05/linuxwget</guid>
    </item>
    
    <item>
      <title>shell执行mysql的SQL语句</title>
      <description>
        <![CDATA[
        <h3>在脚本中执行mysql的SQL语句</h3>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql">    <span class="n">mysql</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span>    
      <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">tableA</span> <span class="n">a</span><span class="p">,</span> <span class="n">tableB</span> <span class="n">b</span>   
      <span class="k">where</span> <span class="n">a</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>  
    <span class="n">EOF</span> 
</code></pre></div>
        ]]>
      </description>
      <pubDate>2014-12-31T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2014/12/31/shellmysql.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2014/12/31/shellmysql</guid>
    </item>
    
    <item>
      <title>shell多行文字合并为一行</title>
      <description>
        <![CDATA[
        <h3>使用awk来进行处理换行问题</h3>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">awk <span class="s1">&#39;{printf (/#/&amp;&amp;NR&gt;1)?&quot;\n&quot;$0:$0}&#39;</span>
</code></pre></div>
        ]]>
      </description>
      <pubDate>2014-12-31T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2014/12/31/shell.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2014/12/31/shell</guid>
    </item>
    
    <item>
      <title>mysqldump命令的用法</title>
      <description>
        <![CDATA[
        <h3>导出表结构不导出数据</h3>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>mysqldump -d -uusername -hhostname -p dbname &gt; tables.sql
</code></pre></div>
<h3>导出表结构不导出数据</h3>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">$</span> <span class="n">mysqldump</span> <span class="o">-</span><span class="n">t</span> <span class="o">-</span><span class="n">uusername</span> <span class="o">-</span><span class="n">hhostname</span> <span class="o">-</span><span class="n">p</span> <span class="n">dbname</span> <span class="o">&gt;</span> <span class="n">datas</span><span class="o">.</span><span class="na">sql</span></code></pre></div>

        ]]>
      </description>
      <pubDate>2014-12-31T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2014/12/31/mysqldump.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2014/12/31/mysqldump</guid>
    </item>
    
    <item>
      <title>nginx平滑升级</title>
      <description>
        <![CDATA[
        <h3>重命名主进程文件</h3>

<p>旧版本 nginx 的主进程将重命名它的 pid 文件为 .oldbin(例如：/usr/local/nginx/logs/nginx.pid.oldbin) </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span><span class="nb">kill</span> -USR2 【旧颁布的Nginx主进程号】  
</code></pre></div>
<h3>同时运行nginx</h3>

<p>新、旧版本的nginx 实例会同时运行，共同处理输入的请求。要逐步停止旧版本的 nginx 实例，你必须发送 WINCH 信号给旧的主进程，然后，它的工作进程就将开始从容关闭 </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span><span class="nb">kill</span> -WINCH 【旧版本的Nginx主进程号】
</code></pre></div>
<h3>升级或恢复</h3>

<p>可以决定是使用新版本，还是恢复到旧版本 </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span><span class="nb">kill</span> 【新的主进程号或旧的主进程号】
</code></pre></div>
        ]]>
      </description>
      <pubDate>2014-11-19T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2014/11/19/nginxupdate.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2014/11/19/nginxupdate</guid>
    </item>
    
    <item>
      <title>confluence安装手册</title>
      <description>
        <![CDATA[
        <h3>环境准备</h3>

<p>操作系统：Linux</p>

<p>confluence版本：5.4.4</p>

<p>数据库：mysql 5 </p>

<h3>软件下载</h3>

<p>confluence安装包：<a href="https://www.atlassian.com/software/confluence/download">atlassian-confluence-5.4.4-x64_1.bin</a></p>

<p>confluence中文包：<a href="http://dl.iteye.com/topics/download/a8e03f06-b333-35cf-9403-90a842c407fa">JIRA-Language-STD-CN.jar</a></p>

<p>confluence破解包：<a href="http://dl.iteye.com/topics/download/2e3ec41d-92aa-348f-9c75-73f10b6fba06">jira_crack.zip</a></p>

<p>mysql驱动：<a href="http://dl.iteye.com/topics/download/7f00832a-b07e-32cb-856f-ce49c545f48a">mysql-connector-java-5.1.34-bin.jar </a></p>

<h3>数据库准备</h3>

<p>创建jiradb数据库 </p>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">confluence</span> <span class="k">CHARACTER</span> <span class="kt">SET</span> <span class="n">utf8</span> <span class="k">COLLATE</span> <span class="n">utf8_bin</span><span class="p">;</span>
</code></pre></div>
<p>权限用户授权</p>
<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">GRANT</span> <span class="k">SELECT</span><span class="p">,</span><span class="k">INSERT</span><span class="p">,</span><span class="k">UPDATE</span><span class="p">,</span><span class="k">DELETE</span><span class="p">,</span><span class="k">CREATE</span><span class="p">,</span><span class="k">DROP</span><span class="p">,</span><span class="k">ALTER</span><span class="p">,</span><span class="k">INDEX</span> <span class="k">on</span> <span class="n">confluence</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;&lt;db user&gt;&#39;</span><span class="o">@</span><span class="s1">&#39;&lt;db hostname&gt;&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;&lt;db password&gt;&#39;</span><span class="p">;</span>  

<span class="n">flush</span> <span class="n">privileges</span><span class="p">;</span>  

<span class="cm">/*  </span>
<span class="cm">例如：  </span>
<span class="cm">GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER,INDEX on confluence.* TO &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;123456&#39;;  </span>
<span class="cm">*/</span>
</code></pre></div>
<h3>系统环境变量</h3>

<p>设置语言为zh<em>CN，如果语言为en</em>US则confluence汉化无法生效，最好在.profile文件中配置</p>

<p>在~/.profile文件最后加以下两行</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">export </span><span class="nv">LANG</span><span class="o">=</span>zh_CN.UTF-8  
<span class="nb">export </span><span class="nv">LANGUAGE</span><span class="o">=</span>zh_CN:zh
</code></pre></div>
<p>重新加载环境变量（在命令行中输入） </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">source</span> ~/.profile
</code></pre></div>
<p>查看locale</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>locale  
<span class="nv">LANG</span><span class="o">=</span>zh_CN.UTF-8  
<span class="nv">LANGUAGE</span><span class="o">=</span>zh_CN:zh  
<span class="nv">LC_CTYPE</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_NUMERIC</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_TIME</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_COLLATE</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_MONETARY</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_MESSAGES</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_PAPER</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_NAME</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_ADDRESS</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_TELEPHONE</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_MEASUREMENT</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_IDENTIFICATION</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>  
<span class="nv">LC_ALL</span><span class="o">=</span>  
</code></pre></div>
<h3>安装confluence（使用root用户安装）</h3>

<p>授予执行权限 </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>chmod +x atlassian-confluence-5.4.4-x64_1.bin
</code></pre></div>
<p>安装jira（安装过程中会提示输入相关配置） </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>./atlassian-confluence-5.4.4-x64_1.bin
</code></pre></div>
<p>关闭confluence（安装后会自动启动服务） </p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>service confluence stop
</code></pre></div>
<h3>加载mysql驱动</h3>

<p>拷贝mysql驱动到jira目录/atlassian/confluence/lib</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>cp mysql-connector-java-5.1.34-bin.jar jira目录/atlassian/confluence/lib/  
</code></pre></div>
<h3>配置confluence</h3>

<p>用浏览器打开confluence的主页面，安装步骤进行配置，其数据库的的配置按照第三步的配置来配置即可。</p>

<p>需要跟jira进行用户整合的请注意（不需的这一步略过），如果你需要跟jira进行结合，那需要注意在jira系统中有一个jira管理员用户是属于jira-system-administrators组，如果没有jira-system-administrators组，则在jira中进行新增并把用户新增到该组。跟jira结合这一步没有配置好，则无法跟jira进行整合。在配置这个一步时，配置有jira-system-administrators组的jira管理员即可。</p>

<p>进入界面后，进入插件管理，将中文包插件上传，将提示安装插件成功。重启confluence服务后，中文生效。</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>service confluence stop  
<span class="nv">$ </span>service confluence start
</code></pre></div>
<h3>破解confluence</h3>

<p>将atlassian-extras-2.4.jar包替换掉confluence中的atlassian-extras-2.4.jar，然后重启confluence服务即可。 </p>

<h3>安装完成</h3>

<h3>备注</h3>

<p>打开confluence官网忙，下载安装包难，这个原因就不多说了 </p>

<p>生成License比较慢，跟上一个问题一样 </p>

        ]]>
      </description>
      <pubDate>2014-11-15T00:00:00+08:00</pubDate>
      <link>http://blog.dinghz.com/2014/11/15/confluence.html</link>
      <guid isPermaLink="false">http://blog.dinghz.com/2014/11/15/confluence</guid>
    </item>
    
  </channel>
</rss>

